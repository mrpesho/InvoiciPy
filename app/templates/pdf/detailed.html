{% extends "pdf/base.html" %}

{% block extra_styles %}
.items-detailed thead th {
    font-size: 8pt;
}
.items-detailed tbody td {
    font-size: 8pt;
}
{% endblock %}

{% block content %}
<div class="header">
    <div class="company-info">
        <h1>{{ company.name }}</h1>
        <p>{{ company.legal_name }}</p>
        <p>{{ company.address }}</p>
        <p>{{ company.zipcode }} {{ company.city }}, {{ company.country }}</p>
        <p>VAT: {{ company.vat_number }}</p>
        {% if company.phone %}<p>Tel: {{ company.phone }}</p>{% endif %}
        {% if company.email %}<p>{{ company.email }}</p>{% endif %}
    </div>
    <div class="invoice-title">
        <h2>INVOICE</h2>
        <div class="invoice-number">{{ invoice.number }}</div>
        <div class="status-badge status-{{ invoice.status }}">{{ invoice.status }}</div>
    </div>
</div>

<div class="parties">
    <div class="party">
        <h3>Bill To</h3>
        <div class="name">{{ customer.name }}</div>
        {% if customer.legal_name %}<p>{{ customer.legal_name }}</p>{% endif %}
        {% if customer.legal_number %}<p>Reg. No: {{ customer.legal_number }}</p>{% endif %}
        {% if customer.address_line1 %}<p>{{ customer.address_line1 }}</p>{% endif %}
        {% if customer.address_line2 %}<p>{{ customer.address_line2 }}</p>{% endif %}
        <p>{{ customer.city }}{% if customer.state %}, {{ customer.state }}{% endif %} {{ customer.zipcode }}</p>
        <p>{{ customer.country }}</p>
        {% if customer.vat_number %}<p>VAT: {{ customer.vat_number }}</p>{% endif %}
        {% if customer.email %}<p>Email: {{ customer.email }}</p>{% endif %}
    </div>
    <div class="party" style="text-align: right;">
        <h3>Invoice Details</h3>
        <p><strong>Invoice No:</strong> {{ invoice.number }}</p>
        <p><strong>Issue Date:</strong> {{ invoice.issue_date }}</p>
        {% if invoice.delivery_date %}
        <p><strong>Delivery Date:</strong> {{ invoice.delivery_date }}</p>
        {% endif %}
        <p><strong>Due Date:</strong> {{ invoice.due_date }}</p>
        <p><strong>Currency:</strong> {{ invoice.currency }}</p>
    </div>
</div>

<table class="items-detailed">
    <thead>
        <tr>
            <th style="width: 5%">#</th>
            <th style="width: 40%">Description</th>
            <th class="number">Quantity</th>
            <th>Unit</th>
            <th class="number">Unit Price</th>
            <th class="number">Tax Rate</th>
            <th class="number">Tax Amount</th>
            <th class="number">Line Total</th>
        </tr>
    </thead>
    <tbody>
        {% for item in items %}
        <tr>
            <td>{{ loop.index }}</td>
            <td>{{ item.description }}</td>
            <td class="number">{{ "%.2f"|format(item.quantity) }}</td>
            <td>{{ item.unit }}</td>
            <td class="number">{{ "%.2f"|format(item.unit_price) }}</td>
            <td class="number">{{ "%.0f"|format(item.tax_rate) }}%</td>
            <td class="number">{{ "%.2f"|format(item.tax_amount) }}</td>
            <td class="number">{{ "%.2f"|format(item.line_total) }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div class="totals">
    <table class="totals-table">
        <tr>
            <td>Subtotal:</td>
            <td>{{ "%.2f"|format(totals.subtotal) }} {{ invoice.currency }}</td>
        </tr>
        <tr>
            <td>Tax Total:</td>
            <td>{{ "%.2f"|format(totals.tax) }} {{ invoice.currency }}</td>
        </tr>
        <tr class="total">
            <td>Grand Total:</td>
            <td>{{ "%.2f"|format(totals.total) }} {{ invoice.currency }}</td>
        </tr>
    </table>
</div>

{% if invoice.notes %}
<div class="notes">
    <h4>Notes</h4>
    <p>{{ invoice.notes }}</p>
</div>
{% endif %}

{% if optional_texts %}
<div class="optional-texts">
    {% for text in optional_texts %}
    <p>{{ text }}</p>
    {% endfor %}
</div>
{% endif %}

<div class="footer">
    {{ company.name }} | {{ company.address }}, {{ company.city }} | VAT: {{ company.vat_number }}
</div>
{% endblock %}
